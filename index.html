<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Venta + | Pro System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F1F5F9; }
        .sidebar { width: 280px; height: 100vh; position: fixed; left: 0; top: 0; background: #0047AB; color: white; transition: all 0.3s ease; }
        .main-content { margin-left: 280px; padding: 40px; min-height: 100vh; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 16px 24px; cursor: pointer; transition: 0.2s; font-weight: 600; opacity: 0.7; }
        .nav-item:hover { opacity: 1; background: rgba(255,255,255,0.1); }
        .nav-item.active { opacity: 1; background: white; color: #0047AB; border-radius: 16px 0 0 16px; margin-left: 12px; }
        .card-fintech { background: white; border-radius: 24px; padding: 24px; border: 1px solid #E2E8F0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .hidden { display: none !important; }
        
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); z-index: 100; }
            .main-content { margin-left: 0; padding: 20px; }
            .sidebar.mobile-open { transform: translateX(0); }
        }
    </style>
</head>
<body>

    <div id="auth-screen" class="min-h-screen flex items-center justify-center p-6 bg-slate-50">
        <div class="w-full max-w-md space-y-8">
            <div class="text-center">
                <h1 class="text-4xl font-black text-slate-900">Mi Venta <span class="text-[#0047AB]">+</span></h1>
                <p class="text-slate-500 mt-2">Sistema de Gesti칩n Profesional</p>
            </div>
            <div class="bg-white p-8 rounded-[32px] shadow-xl space-y-4 border border-slate-100">
                <div id="reg-fields" class="hidden space-y-4">
                    <input type="text" id="auth-name" placeholder="Nombre completo" class="w-full p-4 bg-slate-50 rounded-xl border-none outline-none focus:ring-2 ring-[#0047AB]">
                </div>
                <input type="email" id="auth-email" placeholder="Email" class="w-full p-4 bg-slate-50 rounded-xl border-none outline-none">
                <input type="password" id="auth-pass" placeholder="Contrase침a" class="w-full p-4 bg-slate-50 rounded-xl border-none outline-none">
                <button onclick="handleAuth()" id="btn-main" class="w-full bg-[#0047AB] text-white py-4 rounded-xl font-bold shadow-lg shadow-blue-200">Entrar</button>
                <button onclick="toggleAuth()" id="btn-toggle" class="w-full text-slate-400 text-sm font-medium">쯅o tienes cuenta? Reg칤strate</button>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <aside class="sidebar">
            <div class="p-8">
                <h1 class="text-2xl font-black tracking-tighter">Mi Venta <span class="text-blue-300">+</span></h1>
            </div>
            <nav class="mt-4">
                <div onclick="showTab('dash')" id="tab-dash" class="nav-item active"><span>游늵</span> Dashboard</div>
                <div onclick="showTab('cust')" id="tab-cust" class="nav-item"><span>游논</span> Clientes</div>
                <div onclick="showTab('inv')" id="tab-inv" class="nav-item"><span>游닍</span> Inventario</div>
                <div onclick="showTab('fin')" id="tab-fin" class="nav-item"><span>游눯</span> Finanzas</div>
                <div onclick="logout()" class="nav-item mt-20 text-red-300"><span>游뛁</span> Cerrar Sesi칩n</div>
            </nav>
        </aside>

        <main class="main-content">
            <section id="view-dash" class="space-y-8 animate-in fade-in">
                <header>
                    <h2 id="user-welcome" class="text-3xl font-black text-slate-800">Hola, cargando...</h2>
                    <p class="text-slate-500">Resumen general de tu negocio hoy.</p>
                </header>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card-fintech">
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Ventas del Mes</p>
                        <p class="text-2xl font-black text-[#0047AB]">Gs. 0</p>
                    </div>
                    <div class="card-fintech">
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Total a Recibir</p>
                        <p class="text-2xl font-black text-orange-500">Gs. 0</p>
                    </div>
                    <div class="card-fintech">
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Caja Disponible</p>
                        <p class="text-2xl font-black text-emerald-600">Gs. 0</p>
                    </div>
                </div>
            </section>

            <section id="view-cust" class="hidden space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="text-3xl font-black text-slate-800">Clientes</h2>
                    <button class="bg-[#0047AB] text-white px-6 py-3 rounded-xl font-bold">+ Nuevo Cliente</button>
                </div>
                <div class="card-fintech">
                    <p class="text-slate-400 italic text-center py-10">Aqu칤 aparecer치 tu lista de deudores.</p>
                </div>
            </section>
        </main>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDBntAU1uA5zGGZRW3c0Olxn_fe7-D0EFM",
            authDomain: "miguarani.firebaseapp.com",
            projectId: "miguarani",
            storageBucket: "miguarani.firebasestorage.app",
            messagingSenderId: "526507667874",
            appId: "1:526507667874:web:b5b08c890c832d5f2702fb"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let isLogin = true;

        function toggleAuth() {
            isLogin = !isLogin;
            document.getElementById('reg-fields').classList.toggle('hidden');
            document.getElementById('btn-main').innerText = isLogin ? "Entrar" : "Crear Cuenta Profesional";
            document.getElementById('btn-toggle').innerText = isLogin ? "쯅o tienes cuenta? Reg칤strate" : "쯏a tienes cuenta? Inicia Sesi칩n";
        }

        async function handleAuth() {
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-pass').value;
            try {
                if(isLogin) {
                    await auth.signInWithEmailAndPassword(email, pass);
                } else {
                    const name = document.getElementById('auth-name').value;
                    const res = await auth.createUserWithEmailAndPassword(email, pass);
                    await db.collection('users').doc(res.user.uid).set({ name, email, role: 'OWNER' });
                }
            } catch(e) { alert(e.message); }
        }

        function showTab(tab) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('view-' + tab).classList.remove('hidden');
            document.getElementById('tab-' + tab).classList.add('active');
        }

        auth.onAuthStateChanged(async user => {
            if(user) {
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                const doc = await db.collection('users').doc(user.uid).get();
                document.getElementById('user-welcome').innerText = "Hola, " + (doc.data()?.name || "Empresario");
            } else {
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
            }
        });

        function logout() { auth.signOut(); }
    </script>
</body>
</html>